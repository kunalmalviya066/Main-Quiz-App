<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GovExams Practice App</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<!-- AUTH GUARD (NO FLOW CHANGE) -->
<script>
  const user = localStorage.getItem("loggedInUser");
  if (!user) {
    window.location.href = "auth/login.html";
  }
</script>
<body>

    <header class="main-header">
        <section id="login-gate" class="view">
        <div class="login-container">
            <h2><i class="fas fa-lock"></i> Secure Access</h2>
            <p>Enter the master password(ask to owner or type in password "AccessGrant") to access the GovExams Practice App.</p>
            <input type="password" id="password-input" placeholder="Enter Password" required>
            <p id="login-error" class="error-message hidden"></p>
            <button id="login-button" class="start-button">Access Application</button>
        </div>
    </section>
        <div class="logo">
            <i class="fas fa-graduation-cap"></i> GovExams Mock
        </div>
        <nav>
            <a href="#" id="nav-home" class="nav-link active" data-view="home">Home</a>
            <a href="#" id="nav-subject" class="nav-link" data-view="subject-setup">Subject Practice</a>
            <a href="#" id="nav-daily" class="nav-link" data-view="daily-setup">Daily Quiz</a>
            <a href="#" id="nav-fullmock" class="nav-link" data-view="mock-setup">Full Mock</a>
            <a href="#" id="nav-results" class="nav-link" data-view="result-summary">Result Summary</a>
            <a href="#" id="nav-admin" class="nav-link hidden" data-view="admin-gate">Admin Panel</a>
            <a href="#" id="nav-help" class="nav-link" data-view="help">Help</a>
        </nav>
    </header>
<button id="logoutBtn">Logout</button>

    <main id="app-container">
        
        <section id="home" class="view active">
            <h2>Welcome to GovExams Practice Platform!</h2>
            <p>Select an option below to start your practice session.</p>
            <div class="home-options-grid">
                <button class="home-option-card" data-view-target="subject-setup">
                    <i class="fas fa-book-open"></i>
                    <h3>Subject Practice</h3>
                    <p>Select a subject and specific topics.</p>
                </button>
                <button class="home-option-card" data-view-target="daily-setup">
                    <i class="fas fa-calendar-day"></i>
                    <h3>Daily Quiz</h3>
                    <p>Random questions across all topics.</p>
                </button>
                <button class="home-option-card" data-view-target="mock-setup">
                    <i class="fas fa-clipboard-check"></i>
                    <h3>Full Mock</h3>
                    <p>Subject-wise simulated exam.</p>
                </button>
                <button class="home-option-card" data-view-target="result-summary">
                    <i class="fas fa-chart-line"></i>
                    <h3>Result Summary</h3>
                    <p>Review history and performance analysis.</p>
                </button>
            </div>
        </section>

        <section id="subject-setup" class="view hidden">
            <h2 class="view-title"><i class="fas fa-list-alt"></i> Subject & Topic Selection</h2>
            <div class="setup-form-container">
                <div class="setup-step">
                    <h4>Step 1: Choose Subject</h4>
                    <select id="subject-select"></select>
                </div>
                <div class="setup-step">
                    <h4>Step 2: Select Topics</h4>
                    <div id="topics-checkbox-container" class="topic-list">
                        <p class="placeholder">Select a subject first.</p>
                    </div>
                </div>
                <div class="setup-step-options">
                    <label for="num-questions">Number of Questions:</label>
                    <input type="number" id="num-questions" value="10" min="5" max="100">

                    <label for="timer-minutes">Time Limit (Minutes):</label>
                    <input type="number" id="timer-minutes" value="10" min="1">
                </div>
                <button id="start-subject-quiz" class="start-button"><i class="fas fa-play"></i> Start Subject Quiz</button>
            </div>
        </section>

        <section id="daily-setup" class="view hidden">
            <h2 class="view-title"><i class="fas fa-calendar-day"></i> Daily Quiz Setup</h2>
            <div class="setup-form-container">
                <p>Randomly selected questions from all subjects/topics.</p>
                <div class="setup-step-options">
                    <label for="daily-num-questions">Number of Questions:</label>
                    <input type="number" id="daily-num-questions" value="15" min="5" max="100">

                    <label for="daily-timer-minutes">Time Limit (Minutes):</label>
                    <input type="number" id="daily-timer-minutes" value="15" min="1">
                </div>
                <button id="start-daily-quiz" class="start-button"><i class="fas fa-play"></i> Start Daily Quiz</button>
            </div>
        </section>
        
        <section id="mock-setup" class="view hidden">
            <h2 class="view-title"><i class="fas fa-clipboard-check"></i> Full Mock Setup</h2>
            <div class="setup-form-container">
                <div class="setup-step">
                    <h4>Select Subject for Mock</h4>
                    <select id="mock-subject-select"></select>
                </div>
                <div class="setup-step-options">
                    <label for="mock-num-questions">Number of Questions:</label>
                    <input type="number" id="mock-num-questions" value="50" min="10" max="200">

                    <label for="mock-timer-minutes">Time Limit (Minutes):</label>
                    <input type="number" id="mock-timer-minutes" value="60" min="1">
                </div>
                <button id="start-mock-quiz" class="start-button"><i class="fas fa-play"></i> Start Full Mock</button>
            </div>
        </section>

        <section id="active-quiz" class="view quiz-layout hidden">
            <div class="quiz-area">
                <div class="quiz-top-bar">
                    <div class="quiz-info">
                        <span id="quiz-subject-info">Subject: General Knowledge</span> | 
                        <span id="quiz-topic-info">Topic: Indian History</span>
                    </div>
                    <div class="quiz-timer">
                        <i class="far fa-clock"></i> Time Left: <span id="timer-display">00:00</span>
                    </div>
                    <button id="pause-resume-btn" class="control-btn pause"><i class="fas fa-pause"></i> Pause</button>
                </div>

                <div class="question-container">
                    <div class="question-header">
                        <span id="q-number-display">Question 1 of 10</span>
                    </div>
                    <p id="question-text">Question text will be loaded here...</p>
                    <div id="question-image-container">
                        </div>
                    <div id="options-container" class="options-list">
                        </div>
                </div>

                <div class="quiz-controls-bar">
                    <button id="prev-question-btn" class="control-btn"><i class="fas fa-chevron-left"></i> Previous</button>
                    <button id="clear-answer-btn" class="control-btn secondary"><i class="fas fa-eraser"></i> Clear Answer</button>
                    <button id="mark-review-btn" class="control-btn review"><i class="fas fa-bookmark"></i> Mark for Review</button>
                    <button id="next-question-btn" class="control-btn next"><i class="fas fa-chevron-right"></i> Next</button>
                    <button id="finish-quiz-btn" class="control-btn finish hidden"><i class="fas fa-check-circle"></i> Finish & Submit</button>
                </div>
            </div>

            <div class="quiz-navigator-panel">
                <h4>Question Navigation</h4>
                <div id="question-navigator-grid" class="navigator-grid">
                    </div>
                <div class="navigator-key">
                    <span class="key attempted">Attempted</span>
                    <span class="key unattempted">Unattempted</span>
                    <span class="key marked">Marked</span>
                </div>
                <button id="navigator-finish-btn" class="start-button full-width mt-10"><i class="fas fa-paper-plane"></i> Submit Quiz</button>
            </div>
        </section>

        <section id="result-summary" class="view hidden">
            <h2 class="view-title"><i class="fas fa-chart-line"></i> Performance History</h2>
            <div id="history-list" class="history-container">
                <p id="no-history-message" class="info-message">No quiz history found. Start a practice session!</p>
            </div>
        </section>

        <section id="result-details" class="view hidden">
            <h2 class="view-title"><i class="fas fa-trophy"></i> Quiz Results & Review</h2>
            <div id="result-summary-metrics" class="metrics-card-grid">
                </div>
            
            <div class="review-controls">
                <h3>Question Review</h3>
                <button id="back-to-summary-btn" class="control-btn secondary"><i class="fas fa-arrow-left"></i> Back to History</button>
            </div>
            
            <div id="question-review-list" class="review-list">
                </div>
        </section>
<section id="admin-gate" class="view hidden">
    <div class="login-container">
        <h2><i class="fas fa-user-shield"></i> Admin Login</h2>
        <p>Enter the admin password to manage content.</p>
        <input type="password" id="admin-password-input" placeholder="Admin Password" required>
        <p id="admin-login-error" class="error-message hidden"></p>
        <button id="admin-login-button" class="start-button">Login</button>
    </div>
</section>
<section id="admin-panel" class="view hidden">
        <h2 class="view-title"><i class="fas fa-tools"></i> Admin Content Management</h2>
        
        <div class="admin-controls-grid">
            <button id="show-add-question" class="control-btn primary"><i class="fas fa-plus-circle"></i> Add New Question</button>
            <button id="show-question-list" class="control-btn secondary"><i class="fas fa-list"></i> View/Edit All Questions</button>
            <button id="clear-history-admin" class="control-btn danger"><i class="fas fa-history"></i> Clear All User History</button>
        </div>

        <div id="admin-content-area">
            </div>

    </section>
        <section id="help" class="view hidden">
    <h2 class="view-title"><i class="fas fa-question-circle"></i> Help & Instructions</h2>
    <div class="help-content">

        <h3>üéØ Key Features and Selling Points</h3>
        <ol class="feature-list">
            <li>
                <h4>Zero Downtime & Local Storage üíæ</h4>
                <ul>
                    <li>**Offline Mode:** Practice anytime, anywhere. All questions and logic are stored locally on your device.</li>
                    <li>**Persistent History:** All your quiz results, detailed scores, and review data are saved securely in your browser's **Local Storage**, ensuring your progress is never lost.</li>
                </ul>
            </li>

            <li>
                <h4>Flexible Practice Modes üìö</h4>
                <p>The app offers three distinct practice modes tailored to different stages of preparation:</p>
                <ul>
                    <li>**Subject Practice:** Focus on specific areas. Users can select a **Subject** (e.g., *History*), choose precise **Topics** (e.g., *Mughal Empire*), and set a custom number of questions and time limit.</li>
                    <li>**Daily Quiz:** Perfect for quick revision. This mode selects a random mix of questions across all subjects and topics from the database.</li>
                    <li>**Full Mock Test:** Simulates the actual exam experience subject-wise, pulling a large, randomized set of questions from all topics within a chosen subject.</li>
                </ul>
            </li>

            <li>
                <h4>Authentic Exam Interface & Controls üìù</h4>
                <ul>
                    <li>**Split-Screen UI:** The active quiz interface is divided into two intuitive sections: **Question Area** (for reading the question and selecting options) and **Question Navigator** (for quick jumping between questions).</li>
                    <li>**Standard Controls:** Includes **Previous/Next** navigation, **Mark for Review**, and a **Clear Answer** option to reset a selection.</li>
                    <li>**Live Timer:** A visible timer keeps track of the time remaining, with **Pause** and **Resume** functionality.</li>
                </ul>
            </li>

            <li>
                <h4>Anti-Cheating Measures üõë</h4>
                <ul>
                    <li>**Focus Constraint:** If a user attempts to pause the quiz and switch tabs or minimize the window, the application displays a full-screen **"black screen" overlay**. The user must click **Resume** to regain focus and continue the quiz, simulating the strict environment of a physical exam.</li>
                </ul>
            </li>

            <li>
                <h4>Comprehensive Analysis & Review üìä</h4>
                <ul>
                    <li>**Detailed Scorecard:** Upon submission, receive a breakdown of your score, including **Correct, Wrong, Attempted, Unattempted** questions, and **Accuracy** (calculated only on attempted questions).</li>
                    <li>**In-depth Review:** View every question after the quiz with the following details:
                        <ol type="a">
                            <li>Your Selected Answer vs. the Correct Answer.</li>
                            <li>A Detailed Explanation for the correct solution.</li>
                        </ol>
                    </li>
                    <li>**History Management:** The **Result Summary** section allows you to **View Details** (re-open the detailed review) and **Delete** individual past attempts.</li>
                </ul>
            </li>
        </ol>

        <hr>

        <h3>üìñ Instructions for Use</h3>

        <h4>A. Accessing the Application</h4>
        <ul>
            <li>**Security Gate:** Since this is a restricted practice tool, you must pass a simple client-side **Password Gate** on launch.
                <ul>
                    <li>**Master Password:** <code>ask to owner</code> (Note: This access persists in your browser; you won't need to enter it again until you clear your browser data.)</li>
                </ul>
            </li>
            <li>**Navigation:** Use the links in the header (Subject Practice, Daily Quiz, Full Mock) or the corresponding cards on the Home screen to navigate.</li>
        </ul>

        <h4>B. Starting a Quiz Session</h4>
        <ol>
            <li>**Select Mode:** Go to the desired section (e.g., Subject Practice).</li>
            <li>**Configure:** Use the dropdowns to select your **Subject** and check the boxes for the desired **Topics**.</li>
            <li>**Set Parameters:** Input the **Number of Questions** and the **Time Limit (in minutes)**.</li>
            <li>**Start:** Click the **Start [Mode Name] Quiz** button.</li>
        </ol>

        <h4>C. During the Quiz</h4>
        <ul>
            <li>**Answering:** Click on the radio button next to your chosen option.</li>
            <li>**Navigation:** Use the **Next** and **Previous** buttons at the bottom, or click any numbered button in the **Question Navigator** panel on the right.</li>
            <li>**Reviewing:** Click **Mark for Review** to flag a question. This highlights the question number in the navigator for easy return later.</li>
            <li>**Exiting:** To finish, click **Finish & Submit** (available on the last question) or the **Submit Quiz** button in the navigator panel. **Warning:** Attempting to navigate away or close the app while the quiz is active will prompt you to **Cancel the quiz**, losing all current progress.</li>
        </ul>

        <hr>

        <h3>üìû Support & Feedback</h3>
        <p>If you encounter any issues, have suggestions for new features, or need assistance, please contact us!</p>
        <ul>
            <li>**Support Email:** <a href="helpcontact06@gmail.com">helpcontact06@gmail.com</a></li>
            <li>**Help Documentation:**</li>
            <li>**Project GitHub/Source Code Link.</li>
        </ul>

    </div>
</section>
    </main>

    <div id="quiz-restriction-modal" class="modal hidden">
        <div class="modal-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Active Quiz Alert</h3>
            <p id="restriction-message">A quiz is currently active. Moving to a new section will cancel your current session without saving progress.</p>
            <div class="modal-actions">
                <button id="cancel-quiz-btn" class="control-btn danger"><i class="fas fa-times-circle"></i> Cancel Current Quiz</button>
                <button id="stay-quiz-btn" class="control-btn primary">Stay on Quiz</button>
            </div>
        </div>
    </div>
    
    <div id="pause-screen-overlay" class="overlay hidden">
        <div class="overlay-content">
            <i class="fas fa-exclamation-circle"></i>
            <h3>Quiz Paused - Attention Required</h3>
            <p>Please click 'Resume' below to continue the test. Switching tabs or windows while paused is not allowed in a real exam environment.</p>
            <button id="resume-from-overlay-btn" class="start-button"><i class="fas fa-play"></i> Resume Quiz</button>
        </div>
    </div>


    <script src="db.js"></script>
    <script src="script.js"></script>
    <script src="ai-engine.js"></script>
    <script src="policy-engine.js"></script>
    

    <script>
  document.getElementById("logoutBtn")?.addEventListener("click", () => {
    localStorage.removeItem("loggedInUser");
    window.location.href = "auth/login.html";
  });
</script>

    <!-- LOGIN + LOGOUT HANDLER (NO FLOW BREAK) -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const loginBtn = document.getElementById("login-button");
    const logoutBtn = document.getElementById("logoutBtn");

    if (loginBtn) {
      loginBtn.addEventListener("click", () => {
        const pwd = document.getElementById("password-input").value;
        if (pwd === "ask to owner") {
          localStorage.setItem("isAuthenticated", "true");
          location.reload();
        } else {
          document.getElementById("login-error").textContent = "Invalid password";
          document.getElementById("login-error").classList.remove("hidden");
        }
      });
    }

    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        localStorage.removeItem("isAuthenticated");
        location.reload();
      });
    }
  });
</script>
</body>
</html>